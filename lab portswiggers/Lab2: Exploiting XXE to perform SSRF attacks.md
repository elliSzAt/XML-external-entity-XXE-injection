Description: This lab has a “Check stock” feature that parses XML input and returns any unexpected values in the response. The lab server is running a (simulated) EC2 metadata endpoint at the default URL, which is http://169.254.169.254/. This endpoint can be used to retrieve data about the instance, some of which might be sensitive. To solve the lab, exploit the XXE vulnerability to perform an SSRF attack that obtains the server’s IAM secret access key from the EC2 metadata endpoint.

Lổ hổng của lab này cũng nằm ở tính năng “Check stock”. Để solve được lab này thì ta phải sử dụng XXE để thực thi SSRF đến http://169.254.169.254/ để lấy từ EC2 metadata endpoint.

Ở lab này thì giao diện nó vẫn là cửa hàng giống như lab1 nên mình sẽ proxy phần "check stock" bằng burpsuite.

![image](https://github.com/elliSzAt/XML-external-entity-XXE-injection/assets/125866921/197d9f84-51be-49cc-a558-f0fb3cc6a873)

Đọc phần mô tả, sau đó mình thực hiện request tới địa chỉ ``http://169.254.169.254/`` bằng payload sau:

```
<!DOCTYPE foo [ <!ENTITY xxe SYSTEM "http://169.254.169.254/"> ]>
```

Sau khi sử dụng payload trên thì mình nhận được kết quả trả về như sau:

![image](https://github.com/elliSzAt/XML-external-entity-XXE-injection/assets/125866921/0fd2ea2d-67a3-4daf-ad15-21e3e5be0a94)

Tiếp tục truy cập vào ``http://169.254.169.254/lastest`` thì nó trả về như sau:

![image](https://github.com/elliSzAt/XML-external-entity-XXE-injection/assets/125866921/333e1e2b-4f0e-41cf-b0ca-198264a91452)

Cứ tiếp tục như thế cho đến khi ``http://169.254.169.254/latest/meta-data/iam/security-credentials/admin``.

![image](https://github.com/elliSzAt/XML-external-entity-XXE-injection/assets/125866921/988d8de3-9c5f-4fcc-bbaa-4b587ca7adcf)

Như vậy ta đã hoàn thành xong lab2.
